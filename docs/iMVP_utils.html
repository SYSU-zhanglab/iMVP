<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>iMVP_utils package &mdash; iMVP-utils 0.1.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> iMVP-utils
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="background.html">Background</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="beginners.html">For beginners</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="advanced_users.html">For advanced users</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="UMAP.html">Dimension Reduction Algorithms</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="HDBSCAN.html">Unsupervised Clustering algorithms</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="GPU_accerleration.html">Towards huge datasets</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="limitations.html">Limitations</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="notebooks.html">Notebook indexes</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="gallery.html">Gallery</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">iMVP-utils</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>iMVP_utils package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/iMVP_utils.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="imvp-utils-package">
<h1>iMVP_utils package<a class="headerlink" href="#imvp-utils-package" title="Permalink to this headline"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline"></a></h2>
</section>
<section id="module-iMVP_utils.clustering">
<span id="imvp-utils-clustering-module"></span><h2>iMVP_utils.clustering module<a class="headerlink" href="#module-iMVP_utils.clustering" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="iMVP_utils.clustering.run_HDBSCAN">
<span class="sig-prename descclassname"><span class="pre">iMVP_utils.clustering.</span></span><span class="sig-name descname"><span class="pre">run_HDBSCAN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">soft_clustering</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_cluster_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_selection_epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_selection_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eom'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">draw_condensed_tree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">core_dist_n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#iMVP_utils.clustering.run_HDBSCAN" title="Permalink to this definition"></a></dt>
<dd><p>An implement of HDBSCAN (CPU version)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – A DataFrame with columns X and Y.</p></li>
<li><p><strong>X</strong> (<em>iterable</em>) – A list of X values.</p></li>
<li><p><strong>Y</strong> (<em>iterable</em>) – A list of Y values.</p></li>
<li><p><strong>soft_clustering</strong> (<em>boolean</em>) – Use soft clustering or not. Default=True.</p></li>
<li><p><strong>min_cluster_size</strong> (<em>int</em>) – min_cluster_size in HDBSCAN.</p></li>
<li><p><strong>min_samples</strong> (<em>int</em>) – min_samples in HDBSCAN</p></li>
<li><p><strong>cluster_selection_epsilon</strong> (<em>float</em>) – cluster_selection_epsilon in HDBSCAN</p></li>
<li><p><strong>cluster_selection_method</strong> (<em>str</em>) – cluster_selection_method in HDBSCAN. Should be “eom” or “leaf”.</p></li>
<li><p><strong>draw_condensed_tree</strong> (<em>boolean</em>) – Draw the condensed tree of HDBSCAN or not.</p></li>
<li><p><strong>core_dist_n_jobs</strong> – core_dist_n_jobs in HDBSCAN.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>sequences_onehot</strong> – A list of one-hot encoded sequences.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iMVP_utils.clustering.run_HDBSCAN_GPU">
<span class="sig-prename descclassname"><span class="pre">iMVP_utils.clustering.</span></span><span class="sig-name descname"><span class="pre">run_HDBSCAN_GPU</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_cluster_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_selection_epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_selection_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eom'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#iMVP_utils.clustering.run_HDBSCAN_GPU" title="Permalink to this definition"></a></dt>
<dd><p>An implement of HDBSCAN (GPU version). Only standard clustering mode is available.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – A DataFrame with columns X and Y.</p></li>
<li><p><strong>X</strong> (<em>iterable</em>) – A list of X values.</p></li>
<li><p><strong>Y</strong> (<em>iterable</em>) – A list of Y values.</p></li>
<li><p><strong>min_cluster_size</strong> (<em>int</em>) – min_cluster_size in HDBSCAN.</p></li>
<li><p><strong>min_samples</strong> (<em>int</em>) – min_samples in HDBSCAN</p></li>
<li><p><strong>cluster_selection_epsilon</strong> (<em>float</em>) – cluster_selection_epsilon in HDBSCAN</p></li>
<li><p><strong>cluster_selection_method</strong> (<em>str</em>) – cluster_selection_method in HDBSCAN. Should be “eom” or “leaf”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>sequences_onehot</strong> – A list of one-hot encoded sequences.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iMVP_utils.clustering.run_HDBSCAN_subclustering">
<span class="sig-prename descclassname"><span class="pre">iMVP_utils.clustering.</span></span><span class="sig-name descname"><span class="pre">run_HDBSCAN_subclustering</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Cluster'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">soft_clustering</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_cluster_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_selection_epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_selection_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eom'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">draw_condensed_tree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">core_dist_n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#iMVP_utils.clustering.run_HDBSCAN_subclustering" title="Permalink to this definition"></a></dt>
<dd><p>An implement of HDBSCAN (CPU version) for further clustering of a subcluster.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – A DataFrame with columns X, Y, and clusters.</p></li>
<li><p><strong>soft_clustering</strong> (<em>boolean</em>) – Use soft clustering or not. Default=True.</p></li>
<li><p><strong>min_cluster_size</strong> (<em>int</em>) – min_cluster_size in HDBSCAN.</p></li>
<li><p><strong>min_samples</strong> (<em>int</em>) – min_samples in HDBSCAN</p></li>
<li><p><strong>cluster_selection_epsilon</strong> (<em>float</em>) – cluster_selection_epsilon in HDBSCAN</p></li>
<li><p><strong>cluster_selection_method</strong> (<em>str</em>) – cluster_selection_method in HDBSCAN. Should be “eom” or “leaf”.</p></li>
<li><p><strong>draw_condensed_tree</strong> (<em>boolean</em>) – Draw the condensed tree of HDBSCAN or not.</p></li>
<li><p><strong>core_dist_n_jobs</strong> – core_dist_n_jobs in HDBSCAN.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>sequences_onehot</strong> – A list of one-hot encoded sequences.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iMVP_utils.clustering.run_Leiden">
<span class="sig-prename descclassname"><span class="pre">iMVP_utils.clustering.</span></span><span class="sig-name descname"><span class="pre">run_Leiden</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution_parameter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#iMVP_utils.clustering.run_Leiden" title="Permalink to this definition"></a></dt>
<dd><p>Clustering UMAP result with Leiden.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>graph</strong> (<em>iGraph object</em>) – An iGraph object computed from UMAP nearest neighbor.</p></li>
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – If given, will add a column named “Cluster” to the DataFrame; else will return the labels.</p></li>
<li><p><strong>random_state</strong> (<em>int</em>) – Random seed.</p></li>
<li><p><strong>resolution_parameter</strong> (<em>float</em>) – resolution_parameter for Louvain</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>pd.DataFrame or a list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iMVP_utils.clustering.run_Louvain">
<span class="sig-prename descclassname"><span class="pre">iMVP_utils.clustering.</span></span><span class="sig-name descname"><span class="pre">run_Louvain</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution_parameter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#iMVP_utils.clustering.run_Louvain" title="Permalink to this definition"></a></dt>
<dd><p>Clustering UMAP result with Louvain.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>graph</strong> (<em>iGraph object</em>) – An iGraph object computed from UMAP nearest neighbor.</p></li>
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – If given, will add a column named “Cluster” to the DataFrame; else will return the labels.</p></li>
<li><p><strong>random_state</strong> (<em>int</em>) – Random seed.</p></li>
<li><p><strong>resolution_parameter</strong> (<em>float</em>) – resolution_parameter for Louvain</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>pd.DataFrame or a list</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-iMVP_utils.embedding">
<span id="imvp-utils-embedding-module"></span><h2>iMVP_utils.embedding module<a class="headerlink" href="#module-iMVP_utils.embedding" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="iMVP_utils.embedding.compute_connectivities_umap">
<span class="sig-prename descclassname"><span class="pre">iMVP_utils.embedding.</span></span><span class="sig-name descname"><span class="pre">compute_connectivities_umap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">knn_indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">knn_dists</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_neighbors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_op_mix_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_connectivity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#iMVP_utils.embedding.compute_connectivities_umap" title="Permalink to this definition"></a></dt>
<dd><p>A helper function for Louvain and Leiden. Adopted from Scanpy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>knn_indices</strong> (<em>object</em>) – </p></li>
<li><p><strong>knn_dists</strong> (<em>object</em>) – </p></li>
<li><p><strong>n_obs</strong> (<em>int</em>) – </p></li>
<li><p><strong>n_neighbors</strong> (<em>int</em>) – </p></li>
<li><p><strong>set_op_mix_ratio</strong> (<em>float</em>) – </p></li>
<li><p><strong>local_connectivity</strong> (<em>float</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iMVP_utils.embedding.get_igraph">
<span class="sig-prename descclassname"><span class="pre">iMVP_utils.embedding.</span></span><span class="sig-name descname"><span class="pre">get_igraph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">onehot_input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'euclidean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_neighbors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_kwds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angular</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#iMVP_utils.embedding.get_igraph" title="Permalink to this definition"></a></dt>
<dd><p>Prepare iGraph object for Louvain and Leiden</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>onehot_input</strong> (<em>np.array</em>) – The one-hot encoded sequences.</p></li>
<li><p><strong>random_state</strong> (<em>int</em>) – Random seed.</p></li>
<li><p><strong>metric</strong> (<em>str</em>) – Same as UMAP performed.</p></li>
<li><p><strong>n_neighbors</strong> (<em>int</em>) – Same as UMAP.</p></li>
<li><p><strong>metric_kwds</strong> (<em>dict</em>) – </p></li>
<li><p><strong>angular</strong> (<em>boolean</em>) – </p></li>
<li><p><strong>verbose</strong> (<em>boolean</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>iGraph object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iMVP_utils.embedding.get_igraph_from_adjacency">
<span class="sig-prename descclassname"><span class="pre">iMVP_utils.embedding.</span></span><span class="sig-name descname"><span class="pre">get_igraph_from_adjacency</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adjacency</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#iMVP_utils.embedding.get_igraph_from_adjacency" title="Permalink to this definition"></a></dt>
<dd><p>A helper function for Louvain and Leiden. Adopted from Scanpy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>adjacency</strong> (<em>object</em>) – Generated by compute_connectivities_umap</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>iGraph object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iMVP_utils.embedding.get_sparse_matrix_from_indices_distances_umap">
<span class="sig-prename descclassname"><span class="pre">iMVP_utils.embedding.</span></span><span class="sig-name descname"><span class="pre">get_sparse_matrix_from_indices_distances_umap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">knn_indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">knn_dists</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_neighbors</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#iMVP_utils.embedding.get_sparse_matrix_from_indices_distances_umap" title="Permalink to this definition"></a></dt>
<dd><p>A helper function for Louvain and Leiden. Adopted from Scanpy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>knn_indices</strong> (<em>object</em>) – </p></li>
<li><p><strong>knn_dists</strong> (<em>object</em>) – </p></li>
<li><p><strong>n_obs</strong> (<em>int</em>) – </p></li>
<li><p><strong>n_neighbors</strong> (<em>int</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iMVP_utils.embedding.onehot_encoder_df">
<span class="sig-prename descclassname"><span class="pre">iMVP_utils.embedding.</span></span><span class="sig-name descname"><span class="pre">onehot_encoder_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">column</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'seq'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enc_bases</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ATCGN'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#iMVP_utils.embedding.onehot_encoder_df" title="Permalink to this definition"></a></dt>
<dd><p>This function is used for generate One-Hot encoding sequences from a DataFrame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – A DataFrame.</p></li>
<li><p><strong>column</strong> (<em>str</em><em> or </em><em>tuple</em>) – The column containing the sequences</p></li>
<li><p><strong>enc_bases</strong> (<em>str</em>) – The encoding bases. Default=”ATCGN”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>sequences_onehot</strong> – A list of one-hot encoded sequences.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iMVP_utils.embedding.onehot_encoder_iterable">
<span class="sig-prename descclassname"><span class="pre">iMVP_utils.embedding.</span></span><span class="sig-name descname"><span class="pre">onehot_encoder_iterable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iter_obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enc_bases</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ATCGN'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#iMVP_utils.embedding.onehot_encoder_iterable" title="Permalink to this definition"></a></dt>
<dd><p>This function is used for generate One-Hot encoding sequences from a iterable object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>iter_obj</strong> (<em>iterable</em>) – An iterable object containing the sequences.</p></li>
<li><p><strong>enc_bases</strong> (<em>str</em>) – The encoding bases. Default=”ATCGN”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>sequences_onehot</strong> – A list of one-hot encoded sequences.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iMVP_utils.embedding.run_UMAP">
<span class="sig-prename descclassname"><span class="pre">iMVP_utils.embedding.</span></span><span class="sig-name descname"><span class="pre">run_UMAP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">onehot_input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'random'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_dist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_neighbors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">densmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#iMVP_utils.embedding.run_UMAP" title="Permalink to this definition"></a></dt>
<dd><p>An implement of UMAP (CPU version).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>onehot_input</strong> (<em>iterable.</em>) – A list of one-hot encoded sequences.</p></li>
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – A DataFrame to process. If given, it will return a DataFrame with X and Y columns. If not, it will return X and Y, separatively.</p></li>
<li><p><strong>init</strong> (<em>str.</em>) – init value for UMAP.</p></li>
<li><p><strong>random_state</strong> (<em>int</em>) – random seed.</p></li>
<li><p><strong>min_dist</strong> (<em>float</em>) – min_dist for UMAP</p></li>
<li><p><strong>n_neighbors</strong> (<em>int</em>) – n_neighbors for UMAP</p></li>
<li><p><strong>densmap</strong> (<em>boolean</em>) – If use DensMAP.</p></li>
<li><p><strong>verbose</strong> (<em>boolean</em>) – verbose level</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>A DataFrame or [X and Y]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iMVP_utils.embedding.run_UMAP_GPU">
<span class="sig-prename descclassname"><span class="pre">iMVP_utils.embedding.</span></span><span class="sig-name descname"><span class="pre">run_UMAP_GPU</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">onehot_input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'random'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_dist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_neighbors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">densmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#iMVP_utils.embedding.run_UMAP_GPU" title="Permalink to this definition"></a></dt>
<dd><p>An implement of UMAP (GPU version).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>onehot_input</strong> (<em>iterable.</em>) – A list of one-hot encoded sequences.</p></li>
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – A DataFrame to process. If given, it will return a DataFrame with X and Y columns. If not, it will return X and Y, separatively.</p></li>
<li><p><strong>init</strong> (<em>str.</em>) – init value for UMAP.</p></li>
<li><p><strong>random_state</strong> (<em>int</em>) – random seed.</p></li>
<li><p><strong>min_dist</strong> (<em>float</em>) – min_dist for UMAP</p></li>
<li><p><strong>n_neighbors</strong> (<em>int</em>) – n_neighbors for UMAP</p></li>
<li><p><strong>densmap</strong> (<em>boolean</em>) – If use DensMAP.</p></li>
<li><p><strong>verbose</strong> (<em>boolean</em>) – verbose level</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>A DataFrame or [X and Y]</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-iMVP_utils.interactive">
<span id="imvp-utils-interactive-module"></span><h2>iMVP_utils.interactive module<a class="headerlink" href="#module-iMVP_utils.interactive" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="iMVP_utils.interactive.launch_backend">
<span class="sig-prename descclassname"><span class="pre">iMVP_utils.interactive.</span></span><span class="sig-name descname"><span class="pre">launch_backend</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./output/'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#iMVP_utils.interactive.launch_backend" title="Permalink to this definition"></a></dt>
<dd><p>The function to launch the backend for interactive</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>output_path</strong> (<em>str</em>) – The output directory of the files.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>A Dash App object.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-iMVP_utils.interactive_functions">
<span id="imvp-utils-interactive-functions-module"></span><h2>iMVP_utils.interactive_functions module<a class="headerlink" href="#module-iMVP_utils.interactive_functions" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="iMVP_utils.interactive_functions.UMAP">
<span class="sig-prename descclassname"><span class="pre">iMVP_utils.interactive_functions.</span></span><span class="sig-name descname"><span class="pre">UMAP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">onehot_input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#iMVP_utils.interactive_functions.UMAP" title="Permalink to this definition"></a></dt>
<dd><p>Dimensionality reduction with UMAP</p>
<blockquote>
<div><dl class="simple">
<dt>onehot_input: array</dt><dd><p>One-hot encoding data from sequence.</p>
</dd>
<dt>df: pd.DataFrame</dt><dd><p>Sequence in pd.DataFrame format. It will be added two columns named “X” and “Y” as results of UMAP.</p>
</dd>
</dl>
</div></blockquote>
<dl class="simple">
<dt>Retruns:</dt><dd><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iMVP_utils.interactive_functions.cluster_HDBSCAN">
<span class="sig-prename descclassname"><span class="pre">iMVP_utils.interactive_functions.</span></span><span class="sig-name descname"><span class="pre">cluster_HDBSCAN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#iMVP_utils.interactive_functions.cluster_HDBSCAN" title="Permalink to this definition"></a></dt>
<dd><p>Clustering UMAP results with HDSCAN</p>
<blockquote>
<div><dl class="simple">
<dt>df: pd.DataFrame</dt><dd><p>The results of UMAP computed from UMAP nearst neighbor. After clustering with HDBSCAN, add a columns to it named “Cluster”.</p>
</dd>
<dt>parameters: list</dt><dd><p>Parameters for HDBSCAN from user.</p>
</dd>
</dl>
</div></blockquote>
<blockquote>
<div><p>pd.DataFrame</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iMVP_utils.interactive_functions.draw_logo">
<span class="sig-prename descclassname"><span class="pre">iMVP_utils.interactive_functions.</span></span><span class="sig-name descname"><span class="pre">draw_logo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">infile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#iMVP_utils.interactive_functions.draw_logo" title="Permalink to this definition"></a></dt>
<dd><p>Create sequence logos with Weblogo
Parameters:
———</p>
<blockquote>
<div><dl class="simple">
<dt>infile: string</dt><dd><p>A sequence file in fasta format to create sequence logo with Weblogo.</p>
</dd>
</dl>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A picture of sequence logo in png format.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iMVP_utils.interactive_functions.onehot_enc">
<span class="sig-prename descclassname"><span class="pre">iMVP_utils.interactive_functions.</span></span><span class="sig-name descname"><span class="pre">onehot_enc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">row</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expected_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">21</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#iMVP_utils.interactive_functions.onehot_enc" title="Permalink to this definition"></a></dt>
<dd><p>Encode the data with one-hot encoding
Parameter:
———</p>
<blockquote>
<div><dl class="simple">
<dt>row: string</dt><dd><p>DNA or RNA sequence for one-hot encoding.</p>
</dd>
</dl>
</div></blockquote>
<blockquote>
<div><dl class="simple">
<dt>onehot_array: array</dt><dd><p>one-hot encoding data</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iMVP_utils.interactive_functions.run_cluster">
<span class="sig-prename descclassname"><span class="pre">iMVP_utils.interactive_functions.</span></span><span class="sig-name descname"><span class="pre">run_cluster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fasta_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#iMVP_utils.interactive_functions.run_cluster" title="Permalink to this definition"></a></dt>
<dd><p>Call two algorithms to cluster and get the result
Parameter:
———</p>
<blockquote>
<div><dl class="simple">
<dt>fasta_df: pd.DataFrame</dt><dd><p>Sequence file in pd.DataFrame format. After calling two algorithms, add three columns to it named “X”, “Y” and “Cluster” to store the results.</p>
</dd>
<dt>path: str</dt><dd><p>The output directory.</p>
</dd>
<dt>parameters: list</dt><dd><p>Parameters for HDBSCAN from user input.</p>
</dd>
</dl>
</div></blockquote>
<blockquote>
<div><p>pd.DataFrame</p>
</div></blockquote>
</dd></dl>

</section>
<section id="module-iMVP_utils.plots">
<span id="imvp-utils-plots-module"></span><h2>iMVP_utils.plots module<a class="headerlink" href="#module-iMVP_utils.plots" title="Permalink to this headline"></a></h2>
<p>iMVP plots</p>
<dl class="py function">
<dt class="sig sig-object py" id="iMVP_utils.plots.draw_2D_hist">
<span class="sig-prename descclassname"><span class="pre">iMVP_utils.plots.</span></span><span class="sig-name descname"><span class="pre">draw_2D_hist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">density</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[600,</span> <span class="pre">600]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#iMVP_utils.plots.draw_2D_hist" title="Permalink to this definition"></a></dt>
<dd><p>This function is used for draw a 2D histogram.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – A DataFrame containing the columns X and Y.</p></li>
<li><p><strong>vmax</strong> (<em>float</em>) – The vmax parameter for hist2d. Default=0.05.</p></li>
<li><p><strong>cmin</strong> (<em>float</em>) – The cmin parameter for hist2d. Default=None.</p></li>
<li><p><strong>density</strong> (<em>boolean</em>) – If draw density histogram. Default=True.</p></li>
<li><p><strong>xlim</strong> (<em>tuple</em>) – xlim for hist2d. Default=None.</p></li>
<li><p><strong>ylim</strong> (<em>tuple</em>) – ylim for hist2d. Default=None.</p></li>
<li><p><strong>bins</strong> (<em>tuple</em>) – Bin numbers for hist2d. Default=[600,600]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>hist2d</strong> (<em>np.array</em>) – A 2D array representing the values of the histogram. Please note that this array has been 90-degree rotated to fit the real X-Y and hence can be drawn with plt.imshow() directly.</p></li>
<li><p><strong>edgesX</strong> (<em>np.array</em>) – The X edges.</p></li>
<li><p><strong>edgesY</strong> (<em>np.array</em>) – The Y edges</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iMVP_utils.plots.show_logos_cols">
<span class="sig-prename descclassname"><span class="pre">iMVP_utils.plots.</span></span><span class="sig-name descname"><span class="pre">show_logos_cols</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prefix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(8,</span> <span class="pre">8)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auto_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auto_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auto_height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefig_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#iMVP_utils.plots.show_logos_cols" title="Permalink to this definition"></a></dt>
<dd><p>This function is used for plot a series of motif logos in PNG format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prefix</strong> (<em>str</em>) – The name of output path, required. This function will scan all PNG files in this path.</p></li>
<li><p><strong>names</strong> (<em>tuple</em>) – If given, only plot the given file names. Default=None</p></li>
<li><p><strong>cols</strong> (<em>int</em>) – The number of columns. Default=3</p></li>
<li><p><strong>figsize</strong> (<em>tuple</em>) – The figsize parameter for matplotlib.pyplot.subpolots()</p></li>
<li><p><strong>auto_size</strong> (<em>boolean</em>) – If True, ignore figsze and compute the width and height automatically.</p></li>
<li><p><strong>auto_width</strong> (<em>float</em>) – The width factor used for auto_size.</p></li>
<li><p><strong>auto_height</strong> (<em>float</em>) – The height factor used for auto_size.</p></li>
<li><p><strong>savefig_name</strong> (<em>str</em>) – The plot to save, should end with .pdf or .png or ect. If None, figure will not be drawn.</p></li>
<li><p><strong>dpi</strong> (<em>int</em>) – The dpi value for the figure.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>matplotlib.axes</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="imvp-utils-setup-module">
<h2>iMVP_utils.setup module<a class="headerlink" href="#imvp-utils-setup-module" title="Permalink to this headline"></a></h2>
</section>
<section id="module-iMVP_utils.utils">
<span id="imvp-utils-utils-module"></span><h2>iMVP_utils.utils module<a class="headerlink" href="#module-iMVP_utils.utils" title="Permalink to this headline"></a></h2>
<p>iMVP helper functions.</p>
<dl class="py function">
<dt class="sig sig-object py" id="iMVP_utils.utils.extract_fasta_and_draw_motifs">
<span class="sig-prename descclassname"><span class="pre">iMVP_utils.utils.</span></span><span class="sig-name descname"><span class="pre">extract_fasta_and_draw_motifs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prefix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Cluster'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">motif_column</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'seq'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">draw_logos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#iMVP_utils.utils.extract_fasta_and_draw_motifs" title="Permalink to this definition"></a></dt>
<dd><p>This function is used for quick extraction of sequences strored in a DataFrame into a FASTA file and then draw the motif logos with Weblogo.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prefix</strong> (<em>str</em>) – The name of output path, required.</p></li>
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – A DataFrame containing the sequences used, required.</p></li>
<li><p><strong>cluster_col</strong> (<em>str</em><em> or </em><em>tuple</em>) – The column name for the clusters, default=”Cluster”.</p></li>
<li><p><strong>filter</strong> (<em>boolean</em>) – The column name used for filtering results, where only TRUE values will be used, default=None (not applied).</p></li>
<li><p><strong>motif_column</strong> (<em>str</em><em> or </em><em>tuple</em>) – The column that cotaining the motif sequences, default=”motif_F10”.</p></li>
<li><p><strong>draw_logos</strong> (<em>boolean</em>) – If use Weblogo to draw logos, default=True.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iMVP_utils.utils.hist_to_spots">
<span class="sig-prename descclassname"><span class="pre">iMVP_utils.utils.</span></span><span class="sig-name descname"><span class="pre">hist_to_spots</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hist2d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[600,</span> <span class="pre">600]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_lower</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_upper</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_small_clusters_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_big_clusters_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(12,</span> <span class="pre">12)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figure_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hist2D.png'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#iMVP_utils.utils.hist_to_spots" title="Permalink to this definition"></a></dt>
<dd><p>This function is used for converting 2D histogram to spots (clusters).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hist2d</strong> (<em>str</em>) – The 2D histogram. (From draw_hist2d function)</p></li>
<li><p><strong>cutoff</strong> (<em>int</em>) – The cutoff for cv2.threshold, range from 0 to 255. Default=5.</p></li>
<li><p><strong>bins</strong> (<em>tuple</em>) – Should be equal to that of the hist2D.</p></li>
<li><p><strong>pixel_lower</strong> (<em>int</em>) – The lower limit of the pixels considering as a “small spot”. Spots smaller than this will be ignored.</p></li>
<li><p><strong>pixel_upper</strong> (<em>int</em>) – The upper limit of the pixels considering as a “small spot”. Spots larger than this will be considered as “big spot”</p></li>
<li><p><strong>show_small_clusters_id</strong> (<em>boolean</em>) – If draw the ids for small clusters.</p></li>
<li><p><strong>show_big_clusters_id</strong> (<em>boolean</em>) – If draw the ids for big clusters.</p></li>
<li><p><strong>figsize</strong> (<em>tuple</em>) – Figure size for matplotlib.</p></li>
<li><p><strong>figure_name</strong> (<em>str</em>) – The name of hist2D figure.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>axes</strong> (<em>matplotlib.axes</em>) – The axes.</p></li>
<li><p><em>dict_cnt_small</em> – A dictionary of {id: locations} for the small spots.</p></li>
<li><p><em>dict_cnt_big</em> – A dictionary of {id: locations} for the big spots.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iMVP_utils.utils.load_sequences_from_fasta">
<span class="sig-prename descclassname"><span class="pre">iMVP_utils.utils.</span></span><span class="sig-name descname"><span class="pre">load_sequences_from_fasta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#iMVP_utils.utils.load_sequences_from_fasta" title="Permalink to this definition"></a></dt>
<dd><p>This function is used for load sequences from a FASTA file into a pandas DataFrame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fn</strong> (<em>str</em>) – The file to load.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iMVP_utils.utils.phase_shift">
<span class="sig-prename descclassname"><span class="pre">iMVP_utils.utils.</span></span><span class="sig-name descname"><span class="pre">phase_shift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dict_all_5mers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">column_motif_F10</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'motif_F10'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">current_phase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_base</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'A'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#iMVP_utils.utils.phase_shift" title="Permalink to this definition"></a></dt>
<dd><p>Perform phase shift.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – A DataFrame object with X and Y column.</p></li>
<li><p><strong>dict_all_5mers</strong> (<em>dict</em>) – The dictionary from prepare_kmers_dict.</p></li>
<li><p><strong>cluster_id</strong> (<em>int</em>) – The id of specific cluster.</p></li>
<li><p><strong>column_motif_F10</strong> (<em>str</em>) – The column name of the 10-nt flanking sequences.</p></li>
<li><p><strong>current_phase</strong> (<em>int</em>) – The current phase of the cluster.</p></li>
<li><p><strong>target_base</strong> (<em>str</em>) – The target base to perform phase matching.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iMVP_utils.utils.prepare_kmers_dict">
<span class="sig-prename descclassname"><span class="pre">iMVP_utils.utils.</span></span><span class="sig-name descname"><span class="pre">prepare_kmers_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">column</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'motif_F14'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#iMVP_utils.utils.prepare_kmers_dict" title="Permalink to this definition"></a></dt>
<dd><p>Prepare all kmers from a DataFrame with flanking 14 nt sequences.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – A DataFrame object with X and Y column.</p></li>
<li><p><strong>column</strong> (<em>str</em>) – The name of column containing flanking 14 nt sequences.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iMVP_utils.utils.retrive_clusters">
<span class="sig-prename descclassname"><span class="pre">iMVP_utils.utils.</span></span><span class="sig-name descname"><span class="pre">retrive_clusters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edgesX</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edgesY</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dict_clusters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[600,</span> <span class="pre">600]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_ids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spot_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spot'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#iMVP_utils.utils.retrive_clusters" title="Permalink to this definition"></a></dt>
<dd><p>This function is used for annotate sites with clusters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – A DataFrame object with X and Y column.</p></li>
<li><p><strong>edgesX</strong> (<em>np.array</em>) – The array of X edges generated by hist2D.</p></li>
<li><p><strong>edgesY</strong> (<em>np.array</em>) – The array of Y edges generated by hist2D.</p></li>
<li><p><strong>dict_clusters</strong> (<em>dict</em>) – The dictionary generated by hist_to_spots.</p></li>
<li><p><strong>bins</strong> (<em>tuple</em>) – Should equal to that of hist2D.</p></li>
<li><p><strong>cluster_ids</strong> (<em>iterable</em>) – If given, only find clusters with that ids.</p></li>
<li><p><strong>spot_name</strong> (<em>str</em>) – The column name of the clusters.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-iMVP_utils">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-iMVP_utils" title="Permalink to this headline"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Jianheng Liu, Jing Yao.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>